---
version: 2
interactions:
    - id: 0
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 320
        transfer_encoding: []
        trailer: {}
        host: localhost:8500
        remote_addr: ""
        request_uri: ""
        body: |
            {"ID":"testservice-8080-664d91a5ba","Name":"testservice","Tags":["test1=true","test2=true","secure=false","contextPath=/test","testservice-8080-664d91a5ba"],"Port":8080,"Address":"127.0.0.1","Check":{"Interval":"1s","HTTP":"http://127.0.0.1:8080/test/admin/health","DeregisterCriticalServiceAfter":"15s"},"Checks":null}
        form: {}
        headers:
            Content-Type:
                - application/json
            X-Http-Record-Index:
                - "0"
        url: http://localhost:8500/v1/agent/service/register
        method: PUT
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 0
        uncompressed: false
        body: ""
        headers:
            Content-Length:
                - "0"
            Date:
                - Fri, 19 Aug 2022 8:51:32 GMT
            Vary:
                - Accept-Encoding
            X-Consul-Default-Acl-Policy:
                - deny
        status: 200 OK
        code: 200
        duration: 200µs
    - id: 1
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: localhost:8500
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            X-Http-Record-Index:
                - "1"
        url: http://localhost:8500/v1/catalog/service/testservice?tag=testservice-8080-664d91a5ba
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 850
        uncompressed: false
        body: '[{"ID":"5f3a2831-d061-c469-49d9-d66bbd2b0a1b","Node":"e0aeb9526f77","Address":"127.0.0.1","Datacenter":"dc1","TaggedAddresses":{"lan":"127.0.0.1","lan_ipv4":"127.0.0.1","wan":"127.0.0.1","wan_ipv4":"127.0.0.1"},"NodeMeta":{"consul-network-segment":""},"ServiceKind":"","ServiceID":"testservice-8080-664d91a5ba","ServiceName":"testservice","ServiceTags":["test1=true","test2=true","secure=false","contextPath=/test","testservice-8080-664d91a5ba"],"ServiceAddress":"127.0.0.1","ServiceTaggedAddresses":{"lan_ipv4":{"Address":"127.0.0.1","Port":8080},"wan_ipv4":{"Address":"127.0.0.1","Port":8080}},"ServiceWeights":{"Passing":1,"Warning":1},"ServiceMeta":{},"ServicePort":8080,"ServiceSocketPath":"","ServiceEnableTagOverride":false,"ServiceProxy":{"Mode":"","MeshGateway":{},"Expose":{}},"ServiceConnect":{},"CreateIndex":914979,"ModifyIndex":914979}]'
        headers:
            Content-Length:
                - "850"
            Content-Type:
                - application/json
            Date:
                - Fri, 19 Aug 2022 8:51:32 GMT
            Vary:
                - Accept-Encoding
            X-Consul-Default-Acl-Policy:
                - deny
            X-Consul-Effective-Consistency:
                - leader
            X-Consul-Index:
                - "914979"
            X-Consul-Knownleader:
                - "true"
            X-Consul-Lastcontact:
                - "0"
            X-Consul-Query-Backend:
                - blocking-query
        status: 200 OK
        code: 200
        duration: 200µs
    - id: 2
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: localhost:8500
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            X-Http-Record-Index:
                - "2"
        url: http://localhost:8500/v1/agent/service/deregister/testservice-8080-664d91a5ba
        method: PUT
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 0
        uncompressed: false
        body: ""
        headers:
            Content-Length:
                - "0"
            Date:
                - Fri, 19 Aug 2022 8:51:32 GMT
            Vary:
                - Accept-Encoding
            X-Consul-Default-Acl-Policy:
                - deny
        status: 200 OK
        code: 200
        duration: 200µs
    - id: 3
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: localhost:8500
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            X-Http-Record-Index:
                - "3"
        url: http://localhost:8500/v1/catalog/service/testservice?tag=testservice-8080-664d91a5ba
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 2
        uncompressed: false
        body: '[]'
        headers:
            Content-Length:
                - "2"
            Content-Type:
                - application/json
            Date:
                - Fri, 19 Aug 2022 8:51:32 GMT
            Vary:
                - Accept-Encoding
            X-Consul-Default-Acl-Policy:
                - deny
            X-Consul-Effective-Consistency:
                - leader
            X-Consul-Index:
                - "914980"
            X-Consul-Knownleader:
                - "true"
            X-Consul-Lastcontact:
                - "0"
            X-Consul-Query-Backend:
                - blocking-query
        status: 200 OK
        code: 200
        duration: 200µs
    - id: 4
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 912
        transfer_encoding: []
        trailer: {}
        host: localhost:8500
        remote_addr: ""
        request_uri: ""
        body: |
            {"ID":"testservice-8080-d8755f792d","Name":"testservice","Tags":["test1=true","test2=true","secure=false","contextPath=/test","instanceUuid=e78ccca2-2f64-4ae0-91eb-33f90cdf4951","managedMicroservice","componentAttributes=parent:\u003cnil\u003e~type:\u003cnil\u003e~serviceName:testservice~context:/test~name:\u003cnil\u003e~description:\u003cnil\u003e","name=\u003cnil\u003e","version=Unknown","buildDateTime=2024-01-05T14:28:23-05:00","testservice-8080-d8755f792d"],"Port":8080,"Address":"127.0.0.1","Meta":{"buildDateTime":"2024-01-05T14:28:23-05:00","context":"/test","description":"\u003cnil\u003e","instanceUuid":"e78ccca2-2f64-4ae0-91eb-33f90cdf4951","name":"\u003cnil\u003e","parent":"\u003cnil\u003e","serviceName":"testservice","type":"\u003cnil\u003e","version":"Unknown"},"Check":{"Interval":"1s","HTTP":"http://127.0.0.1:8080/test/admin/health","DeregisterCriticalServiceAfter":"15s"},"Checks":null}
        form: {}
        headers:
            Content-Type:
                - application/json
            X-Http-Record-Index:
                - "4"
        url: http://localhost:8500/v1/agent/service/register
        method: PUT
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 0
        uncompressed: false
        body: ""
        headers:
            Content-Length:
                - "0"
            Date:
                - Fri, 19 Aug 2022 8:51:32 GMT
            Vary:
                - Accept-Encoding
            X-Consul-Default-Acl-Policy:
                - deny
        status: 200 OK
        code: 200
        duration: 200µs
    - id: 5
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: localhost:8500
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            X-Http-Record-Index:
                - "5"
        url: http://localhost:8500/v1/catalog/service/testservice?tag=testservice-8080-d8755f792d
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: -1
        uncompressed: true
        body: '[{"ID":"5f3a2831-d061-c469-49d9-d66bbd2b0a1b","Node":"e0aeb9526f77","Address":"127.0.0.1","Datacenter":"dc1","TaggedAddresses":{"lan":"127.0.0.1","lan_ipv4":"127.0.0.1","wan":"127.0.0.1","wan_ipv4":"127.0.0.1"},"NodeMeta":{"consul-network-segment":""},"ServiceKind":"","ServiceID":"testservice-8080-d8755f792d","ServiceName":"testservice","ServiceTags":["test1=true","test2=true","secure=false","contextPath=/test","instanceUuid=e78ccca2-2f64-4ae0-91eb-33f90cdf4951","managedMicroservice","componentAttributes=parent:\u003cnil\u003e~type:\u003cnil\u003e~serviceName:testservice~context:/test~name:\u003cnil\u003e~description:\u003cnil\u003e","name=\u003cnil\u003e","version=Unknown","buildDateTime=2024-01-05T14:28:23-05:00","testservice-8080-d8755f792d"],"ServiceAddress":"127.0.0.1","ServiceTaggedAddresses":{"lan_ipv4":{"Address":"127.0.0.1","Port":8080},"wan_ipv4":{"Address":"127.0.0.1","Port":8080}},"ServiceWeights":{"Passing":1,"Warning":1},"ServiceMeta":{"buildDateTime":"2024-01-05T14:28:23-05:00","context":"/test","description":"\u003cnil\u003e","instanceUuid":"e78ccca2-2f64-4ae0-91eb-33f90cdf4951","name":"\u003cnil\u003e","parent":"\u003cnil\u003e","serviceName":"testservice","type":"\u003cnil\u003e","version":"Unknown"},"ServicePort":8080,"ServiceSocketPath":"","ServiceEnableTagOverride":false,"ServiceProxy":{"Mode":"","MeshGateway":{},"Expose":{}},"ServiceConnect":{},"CreateIndex":914981,"ModifyIndex":914981}]'
        headers:
            Content-Type:
                - application/json
            Date:
                - Fri, 19 Aug 2022 8:51:32 GMT
            Vary:
                - Accept-Encoding
            X-Consul-Default-Acl-Policy:
                - deny
            X-Consul-Effective-Consistency:
                - leader
            X-Consul-Index:
                - "914981"
            X-Consul-Knownleader:
                - "true"
            X-Consul-Lastcontact:
                - "0"
            X-Consul-Query-Backend:
                - blocking-query
        status: 200 OK
        code: 200
        duration: 200µs
    - id: 6
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: localhost:8500
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            X-Http-Record-Index:
                - "6"
        url: http://localhost:8500/v1/agent/service/deregister/testservice-8080-d8755f792d
        method: PUT
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 0
        uncompressed: false
        body: ""
        headers:
            Content-Length:
                - "0"
            Date:
                - Fri, 19 Aug 2022 8:51:32 GMT
            Vary:
                - Accept-Encoding
            X-Consul-Default-Acl-Policy:
                - deny
        status: 200 OK
        code: 200
        duration: 200µs
    - id: 7
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: localhost:8500
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            X-Http-Record-Index:
                - "7"
        url: http://localhost:8500/v1/catalog/service/testservice?tag=testservice-8080-d8755f792d
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 2
        uncompressed: false
        body: '[]'
        headers:
            Content-Length:
                - "2"
            Content-Type:
                - application/json
            Date:
                - Fri, 19 Aug 2022 8:51:32 GMT
            Vary:
                - Accept-Encoding
            X-Consul-Default-Acl-Policy:
                - deny
            X-Consul-Effective-Consistency:
                - leader
            X-Consul-Index:
                - "914982"
            X-Consul-Knownleader:
                - "true"
            X-Consul-Lastcontact:
                - "0"
            X-Consul-Query-Backend:
                - blocking-query
        status: 200 OK
        code: 200
        duration: 200µs
