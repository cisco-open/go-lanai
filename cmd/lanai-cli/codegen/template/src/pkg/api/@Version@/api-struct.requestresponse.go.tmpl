{{- $rootData := . }}
{{- $pathName := index . "PathName" }}
{{- $version := index . "Version" }}
{{- $pkgName := concat "pkg/api/" $version}}
// Package {{$version}} Generated by lanai_cli codegen. DO NOT EDIT
// Derived from path: {{$pathName}}
package {{$version}}
{{- template "Imports" $rootData }}
{{- with index . "PathData" }}
    {{- range $opName, $opData := pathOperations . }}
        {{- $defaultName := defaultNameFromPath $pathName }}
        {{- $operation := concat $defaultName $opName | operation $opData }}
        {{- template "structsForOperation" args $operation $pkgName }}
    {{- end }}
{{ end }}

{{ define "Imports" }}
    {{- /* Based on the structs imported by this path, define imports */ -}}
    {{- $pathData := index . "PathData" }}
    {{- $repo := index . "Repository" }}
    {{- with importsUsedByPath $pathData $repo}}
        import (
            {{- range . }}
            "{{.}}"
            {{- end }}
        )
    {{- end }}
{{- end }}

{{ define "structsForOperation" }}
    {{- /* Given an operation (and operation name), make applicable request and response struct */ -}}
    {{- $operation := index . 0 }}
    {{- $currentPkg := index . 1 }}

    {{- with $operation }}
        {{ template "RequestStruct" args $operation $currentPkg }}
        {{ template "ResponseStructGroup" args $operation $currentPkg }}
    {{- end }}
{{- end }}
