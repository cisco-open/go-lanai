{{- $rootData := . }}
{{- $pathName := index . "PathName" }}
{{- $version := index . "Version" }}
{{- $pkgName := concat "pkg/api/" $version}}
// Package {{$version}} Generated by lanai_cli codegen. DO NOT EDIT
// Derived from path: {{$pathName}}
package {{$version}}

{{- /* Based on the structs imported by this path, define imports */ -}}
{{- $pathData := index . "PathData" }}
{{- $repo := index . "Repository" }}
{{- with importsUsedByPath $pathData $repo}}
    {{ $imports := NewImports }}
    {{- range . }}
        {{ $imports = $imports.Add . }}
    {{- end }}
    {{ template "imports" $imports }}
{{- end }}

{{- with index . "PathData" }}
    {{- range $opName, $opData := .Operations }}
        {{- $defaultName := defaultNameFromPath $pathName }}
        {{- $operation := toLower $opName | toTitle | concat $defaultName | operation $opData }}
        {{- template "structsForOperation" args $operation $pkgName }}
    {{- end }}
{{ end }}

{{ define "structsForOperation" }}
    {{- /* Given an operation (and operation name), make applicable request and response struct */ -}}
    {{- $operation := index . 0 }}
    {{- $currentPkg := index . 1 }}

    {{- with $operation }}
        {{ template "RequestStruct" args $operation $currentPkg }}
        {{ template "ResponseStructGroup" args $operation $currentPkg }}
    {{- end }}
{{- end }}
